var t=0;function e(e){return"__private_"+t+++"_"+e}function i(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}const s=document.createElement("template");s.innerHTML="\n<style>\n:host {\n    position:           absolute;\n    top:                10px;\n    right:              10px;\n}\nroot {\n    top:                10px;\n    right:              10px;\n    width:              289px; \n    height:             120px;\n    display:            block;\n    background-color:   #75a8f77a;\n}\nroot * {\n    position:           relative;\n}\n.button-wrapper, .axes-wrapper {\n    display:            flex;\n    flex-wrap:          wrap;\n    float:              left;\n}\nroot .button-div {\n    border: solid 1px black;\n    width:              60px;\n    margin:             5px;\n    padding:            5px;\n}\n.button-wrapper {\n    width:              164px;\n}\n.axes-wrapper {\n    width:              115px;\n    margin:             5px;\n}\n.axes-cell {\n    width:              25px;  \n    height:             25px; \n    margin:             5px;  \n    border:             solid 1px transparent;\n}\n.axes-cell.direction {\n    border:             solid 1px black;\n}\n.axes-cell.center{\n    border:             solid 1px black;\n    background-color:   blue;\n}\n.axes-cell.active{\n    background-color:   red;\n}\n.identifier{\n    position:           absolute;\n    top:                5px;\n    left:               5px;\n    width:              auto;\n    font-weight:        bold;\n    color:              #fff;\n}\n</style>";var n=/*#__PURE__*/e("panelHeight"),r=/*#__PURE__*/e("panelSpacing"),o=/*#__PURE__*/e("joystick"),a=/*#__PURE__*/e("numberOfButtons"),h=/*#__PURE__*/e("buttonDivs"),d=/*#__PURE__*/e("left"),c=/*#__PURE__*/e("right"),l=/*#__PURE__*/e("up"),u=/*#__PURE__*/e("down"),p=/*#__PURE__*/e("rootElement"),b=/*#__PURE__*/e("createListenersForButtons"),v=/*#__PURE__*/e("handleButtonClicks"),m=/*#__PURE__*/e("createHTMLForButtons"),y=/*#__PURE__*/e("createHTMLForAxes");class f extends HTMLElement{constructor(t,e){super(),Object.defineProperty(this,y,{value:j}),Object.defineProperty(this,m,{value:x}),Object.defineProperty(this,v,{value:w}),Object.defineProperty(this,b,{value:g}),Object.defineProperty(this,n,{writable:!0,value:120}),Object.defineProperty(this,r,{writable:!0,value:10}),Object.defineProperty(this,o,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,h,{writable:!0,value:[]}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),this.Axes=[],i(this,o)[o]=t,i(this,a)[a]=e;let f=i(this,r)[r]+i(this,o)[o].JoystickNumber*(i(this,n)[n]+i(this,r)[r]);this.style.top=f+"px",i(this,p)[p]=document.createElement("root"),i(this,p)[p].style.height=i(this,n)[n]+"px",s.appendChild(i(this,p)[p]);let k=document.createElement("div");if(k.classList.add("identifier"),k.innerHTML="#"+i(this,o)[o].JoystickNumber,i(this,p)[p].appendChild(k),i(this,y)[y](),i(this,m)[m](),i(this,b)[b](),this.attachShadow({mode:"open"}),this.shadowRoot){let t=s.content.cloneNode(!0);t.appendChild(i(this,p)[p]),this.shadowRoot.appendChild(t)}document.body.appendChild(this)}update(){0==this.Axes[0]?(i(this,d)[d].classList.remove("active"),i(this,c)[c].classList.remove("active")):this.Axes[0]<0?i(this,d)[d].classList.add("active"):this.Axes[0]>0&&i(this,c)[c].classList.add("active"),0==this.Axes[1]?(i(this,l)[l].classList.remove("active"),i(this,u)[u].classList.remove("active")):this.Axes[1]<0?i(this,l)[l].classList.add("active"):this.Axes[1]>0&&i(this,u)[u].classList.add("active")}}function g(){for(let t=0;t<i(this,a)[a];t++)document.addEventListener(i(this,o)[o].ButtonEvents[t],e=>i(this,v)[v](e,t))}function w(t,e){i(this,h)[h][e].style.filter="hue-rotate("+360*Math.random()+"deg)"}function x(){let t=document.createElement("div");t.className="button-wrapper";for(let e=0;e<i(this,a)[a];e++){let s=document.createElement("div");s.className="button-div",t.appendChild(s),s.style.backgroundColor="blue",s.innerHTML="Button "+(e+1),i(this,h)[h].push(s)}i(this,p)[p].appendChild(t)}function j(){let t=document.createElement("div");t.className="axes-wrapper";for(let e=1;e<=9;e++){let s=document.createElement("div");switch(s.className="axes-cell",e%2==0&&s.classList.add("direction"),5==e&&s.classList.add("center"),t.appendChild(s),e){case 2:i(this,l)[l]=s;break;case 4:i(this,d)[d]=s;break;case 6:i(this,c)[c]=s;break;case 8:i(this,u)[u]=s}}i(this,p)[p].appendChild(t)}window.customElements.define("debug-panel",f);var k=/*#__PURE__*/e("DEBUG"),P=/*#__PURE__*/e("BUT1"),E=/*#__PURE__*/e("BUT2"),O=/*#__PURE__*/e("joystickNumber"),N=/*#__PURE__*/e("numberOfBUttons"),L=/*#__PURE__*/e("buttonEvents"),J=/*#__PURE__*/e("axes"),G=/*#__PURE__*/e("gamepad"),B=/*#__PURE__*/e("previousGamepad"),C=/*#__PURE__*/e("previousJoystickDirection"),T=/*#__PURE__*/e("readGamepad"),A=/*#__PURE__*/e("buttonPressed");class M{get Left(){return-1==i(this,J)[J][0]}get Right(){return 1==i(this,J)[J][0]}get Up(){return-1==i(this,J)[J][1]}get Down(){return 1==i(this,J)[J][1]}get Neutral(){return 0==i(this,J)[J][0]&&0==i(this,J)[J][1]}get Y(){return Math.round(i(this,J)[J][1])}get X(){return Math.round(i(this,J)[J][0])}get JoystickNumber(){return i(this,O)[O]}get ButtonEvents(){return i(this,L)[L]}get Gamepad(){return i(this,G)[G]}set Gamepad(t){i(this,G)[G]=t}get PreviousGamepad(){return i(this,B)[B]}set PreviousGamepad(t){i(this,B)[B]=t}constructor(t,e,s){Object.defineProperty(this,A,{value:H}),Object.defineProperty(this,T,{value:D}),Object.defineProperty(this,k,{writable:!0,value:!0}),Object.defineProperty(this,P,{writable:!0,value:8}),Object.defineProperty(this,E,{writable:!0,value:9}),Object.defineProperty(this,O,{writable:!0,value:0}),Object.defineProperty(this,N,{writable:!0,value:0}),Object.defineProperty(this,L,{writable:!0,value:[]}),Object.defineProperty(this,J,{writable:!0,value:[]}),Object.defineProperty(this,G,{writable:!0,value:void 0}),Object.defineProperty(this,B,{writable:!0,value:void 0}),Object.defineProperty(this,C,{writable:!0,value:void 0}),i(this,O)[O]=t,i(this,N)[N]=e,i(this,k)[k]=s;for(let t=0;t<i(this,N)[N];t++)i(this,L)[L].push("joystick"+this.JoystickNumber+"button"+t);i(this,L)[L].push("joystick"+this.JoystickNumber+"neutral"),i(this,L)[L].push("joystick"+this.JoystickNumber+"left"),i(this,L)[L].push("joystick"+this.JoystickNumber+"right"),i(this,L)[L].push("joystick"+this.JoystickNumber+"up"),i(this,L)[L].push("joystick"+this.JoystickNumber+"down"),i(this,C)[C]="neutral",i(this,k)[k]&&(this.debugPanel=new f(this,i(this,N)[N]))}update(){if(void 0===i(this,G)[G]||void 0===i(this,G)[G].index||void 0===navigator.getGamepads()[i(this,G)[G].index])return;let t=navigator.getGamepads()[i(this,G)[G].index];t&&i(this,T)[T](t)}destroy(){i(this,k)[k]&&this.debugPanel.remove()}}function D(t){for(let e=0;e<i(this,N)[N];e++)i(this,A)[A](t.buttons[e])&&!i(this,A)[A](i(this,B)[B].buttons[e])&&document.dispatchEvent(new Event(i(this,L)[L][e])),!i(this,A)[A](t.buttons[i(this,P)[P]])||!i(this,A)[A](t.buttons[i(this,E)[E]])||i(this,A)[A](i(this,B)[B].buttons[i(this,P)[P]])&&i(this,A)[A](i(this,B)[B].buttons[i(this,E)[E]])||document.dispatchEvent(new Event("redirect"));i(this,J)[J][0]=Math.round(t.axes[0]),i(this,J)[J][1]=Math.round(t.axes[1]),i(this,k)[k]&&(this.debugPanel.Axes[0]=i(this,J)[J][0],this.debugPanel.Axes[1]=i(this,J)[J][1],this.debugPanel.update()),this.Left&&"left"!==i(this,C)[C]&&(i(this,C)[C]="left",document.dispatchEvent(new Event("joystick"+this.JoystickNumber+"left"))),this.Right&&"right"!==i(this,C)[C]&&(i(this,C)[C]="right",document.dispatchEvent(new Event("joystick"+this.JoystickNumber+"right"))),this.Up&&"up"!==i(this,C)[C]&&(i(this,C)[C]="up",document.dispatchEvent(new Event("joystick"+this.JoystickNumber+"up"))),this.Down&&"down"!==i(this,C)[C]&&(i(this,C)[C]="down",document.dispatchEvent(new Event("joystick"+this.JoystickNumber+"down"))),this.Neutral&&"neutral"!==i(this,C)[C]&&(i(this,C)[C]="neutral",document.dispatchEvent(new Event("joystick"+this.JoystickNumber+"neutral"))),i(this,B)[B]=t}function H(t){return"object"==typeof t?t.pressed:1==t}var R=/*#__PURE__*/e("DEBUG"),U=/*#__PURE__*/e("joysticks"),_=/*#__PURE__*/e("REDIRECT_URL"),S=/*#__PURE__*/e("multiplayer"),F=/*#__PURE__*/e("game"),I=/*#__PURE__*/e("onRedirect"),X=/*#__PURE__*/e("onGamePadConnected"),Y=/*#__PURE__*/e("onGamePadDisconnected"),q=/*#__PURE__*/e("showStatus"),z=/*#__PURE__*/e("removeStatus");class K{get Joysticks(){return i(this,U)[U]}constructor(t,e=!1,s=!1){Object.defineProperty(this,z,{value:$}),Object.defineProperty(this,q,{value:Z}),Object.defineProperty(this,Y,{value:W}),Object.defineProperty(this,X,{value:V}),Object.defineProperty(this,I,{value:Q}),Object.defineProperty(this,R,{writable:!0,value:void 0}),Object.defineProperty(this,U,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:"http://hr-cmgt.github.io/arcade-server"}),Object.defineProperty(this,S,{writable:!0,value:!1}),Object.defineProperty(this,F,{writable:!0,value:void 0}),i(this,F)[F]=t,i(this,S)[S]=e,i(this,R)[R]=s,i(this,U)[U]=[],i(this,R)[R]&&i(this,q)[q]("Gamepad is NOT connected. Press a button to connect"),document.addEventListener("redirect",()=>i(this,I)[I]()),window.addEventListener("gamepadconnected",t=>i(this,X)[X](t)),window.addEventListener("gamepaddisconnected",t=>i(this,Y)[Y](t))}createAndAddJoystick(t,e){let s=this.getJoystickByNumber(t);if(null!=s)return s;let n=new M(t,e,i(this,R)[R]);return i(this,U)[U][t]=n,n&&(document.dispatchEvent(new CustomEvent("joystickcreated",{detail:t})),console.log("joystick created")),n}removeJoystick(t){let e=this.getJoystickByNumber(t);if(null!=e){var s=i(this,U)[U].indexOf(e);"function"==typeof i(this,U)[U][s].destroy&&i(this,U)[U][s].destroy(),s>-1&&i(this,U)[U].splice(s,1)}}getJoystickByNumber(t){for(let e of i(this,U)[U])if(e.JoystickNumber==t)return e;return null}}function Q(){i(this,R)[R]&&console.log("redirect!!"),window.location.href=i(this,_)[_]}function V(t){if(i(this,R)[R]&&(console.log("Game pad connected"),console.log("Joystick number: "+t.gamepad.index)),!i(this,S)[S]&&0==i(this,U)[U].length||i(this,S)[S]){let e=this.createAndAddJoystick(t.gamepad.index,6);e.PreviousGamepad=e.Gamepad,e.Gamepad=t.gamepad,null==e.PreviousGamepad&&(e.PreviousGamepad=t.gamepad)}i(this,R)[R]&&i(this,z)[z]()}function W(t){i(this,R)[R]&&console.log("Game pad disconnected"),i(this,R)[R]&&i(this,q)[q]("Gamepad is NOT connected. Connect the gamepad and press a button."),this.removeJoystick(t.gamepad.index),i(this,F)[F].disconnect()}function Z(t){let e,i;(e=document.getElementsByTagName("status")[0])||(e=document.createElement("status"),document.body.append(e)),e&&((i=e.getElementsByTagName("p")[0])||(i=document.createElement("p"),e.appendChild(i))),i&&(i.innerHTML=t)}function $(){let t;(t=document.getElementsByTagName("status")[0])&&t.remove()}export{K as Arcade};
//# sourceMappingURL=arcade.modern.mjs.map
