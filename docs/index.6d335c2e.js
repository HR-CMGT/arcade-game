const t=document.createElement("template");t.innerHTML="\n<style>\n:host {\n    position:           absolute;\n    top:                10px;\n    right:              10px;\n}\nroot {\n    top:                10px;\n    right:              10px;\n    width:              289px; \n    height:             120px;\n    display:            block;\n    background-color:   #75a8f77a;\n}\nroot * {\n    position:           relative;\n}\n.button-wrapper, .axes-wrapper {\n    display:            flex;\n    flex-wrap:          wrap;\n    float:              left;\n}\nroot .button-div {\n    border: solid 1px black;\n    width:              60px;\n    margin:             5px;\n    padding:            5px;\n}\n.button-wrapper {\n    width:              164px;\n}\n.axes-wrapper {\n    width:              115px;\n    margin:             5px;\n}\n.axes-cell {\n    width:              25px;  \n    height:             25px; \n    margin:             5px;  \n    border:             solid 1px transparent;\n}\n.axes-cell.direction {\n    border:             solid 1px black;\n}\n.axes-cell.center{\n    border:             solid 1px black;\n    background-color:   blue;\n}\n.axes-cell.active{\n    background-color:   red;\n}\n.identifier{\n    position:           absolute;\n    top:                5px;\n    left:               5px;\n    width:              auto;\n    font-weight:        bold;\n    color:              #fff;\n}\n</style>";class e extends HTMLElement{#t=120;#e=10;#s;#i;#n=[];#o;#a;#r;#c;#d;Axes=[];constructor(e,s){super(),this.#s=e,this.#i=s;let i=this.#e+this.#s.JoystickNumber*(this.#t+this.#e);this.style.top=i+"px",this.#d=document.createElement("root"),this.#d.style.height=this.#t+"px",t.appendChild(this.#d);let n=document.createElement("div");if(n.classList.add("identifier"),n.innerHTML="#"+this.#s.JoystickNumber,this.#d.appendChild(n),this.#h(),this.#u(),this.#p(),this.attachShadow({mode:"open"}),this.shadowRoot){let e=t.content.cloneNode(!0);e.appendChild(this.#d),this.shadowRoot.appendChild(e)}document.body.appendChild(this)}#p(){for(let t=0;t<this.#i;t++)document.addEventListener(this.#s.ButtonEvents[t],(e=>this.#l(e,t)))}#l(t,e){this.#n[e].style.filter="hue-rotate("+360*Math.random()+"deg)"}#u(){let t=document.createElement("div");t.className="button-wrapper";for(let e=0;e<this.#i;e++){let s=document.createElement("div");s.className="button-div",t.appendChild(s),s.style.backgroundColor="blue",s.innerHTML="Button "+(e+1),this.#n.push(s)}this.#d.appendChild(t)}#h(){let t=document.createElement("div");t.className="axes-wrapper";for(let e=1;e<=9;e++){let s=document.createElement("div");switch(s.className="axes-cell",e%2==0&&s.classList.add("direction"),5==e&&s.classList.add("center"),t.appendChild(s),e){case 2:this.#r=s;break;case 4:this.#o=s;break;case 6:this.#a=s;break;case 8:this.#c=s}}this.#d.appendChild(t)}update(){0==this.Axes[0]?(this.#o.classList.remove("active"),this.#a.classList.remove("active")):this.Axes[0]<0?this.#o.classList.add("active"):this.Axes[0]>0&&this.#a.classList.add("active"),0==this.Axes[1]?(this.#r.classList.remove("active"),this.#c.classList.remove("active")):this.Axes[1]<0?this.#r.classList.add("active"):this.Axes[1]>0&&this.#c.classList.add("active")}}window.customElements.define("debug-panel",e);class s{#m=!0;#y=8;#v=9;#b=0;#g=0;#k=[];#E=[];#x;#f;#w;get Left(){return-1==this.#E[0]}get Right(){return 1==this.#E[0]}get Up(){return-1==this.#E[1]}get Down(){return 1==this.#E[1]}get Neutral(){return 0==this.#E[0]&&0==this.#E[1]}get Y(){return Math.round(this.#E[1])}get X(){return Math.round(this.#E[0])}get JoystickNumber(){return this.#b}get ButtonEvents(){return this.#k}get Gamepad(){return this.#x}set Gamepad(t){this.#x=t}get PreviousGamepad(){return this.#f}set PreviousGamepad(t){this.#f=t}constructor(t,s,i){this.#b=t,this.#g=s,this.#m=i;for(let t=0;t<this.#g;t++)this.#k.push("joystick"+this.JoystickNumber+"button"+t);this.#k.push("joystick"+this.JoystickNumber+"neutral"),this.#k.push("joystick"+this.JoystickNumber+"left"),this.#k.push("joystick"+this.JoystickNumber+"right"),this.#k.push("joystick"+this.JoystickNumber+"up"),this.#k.push("joystick"+this.JoystickNumber+"down"),this.#w="neutral",this.#m&&(this.debugPanel=new e(this,this.#g))}update(){if(void 0===this.#x||void 0===this.#x.index||void 0===navigator.getGamepads()[this.#x.index])return;let t=navigator.getGamepads()[this.#x.index];t&&this.#B(t)}#B(t){for(let e=0;e<this.#g;e++)this.#G(t.buttons[e])&&!this.#G(this.#f.buttons[e])&&document.dispatchEvent(new Event(this.#k[e])),!this.#G(t.buttons[this.#y])||!this.#G(t.buttons[this.#v])||this.#G(this.#f.buttons[this.#y])&&this.#G(this.#f.buttons[this.#v])||document.dispatchEvent(new Event("redirect"));this.#E[0]=Math.round(t.axes[0]),this.#E[1]=Math.round(t.axes[1]),this.#m&&(this.debugPanel.Axes[0]=this.#E[0],this.debugPanel.Axes[1]=this.#E[1],this.debugPanel.update()),this.Left&&"left"!==this.#w&&(this.#w="left",document.dispatchEvent(new Event("joystick"+this.JoystickNumber+"left"))),this.Right&&"right"!==this.#w&&(this.#w="right",document.dispatchEvent(new Event("joystick"+this.JoystickNumber+"right"))),this.Up&&"up"!==this.#w&&(this.#w="up",document.dispatchEvent(new Event("joystick"+this.JoystickNumber+"up"))),this.Down&&"down"!==this.#w&&(this.#w="down",document.dispatchEvent(new Event("joystick"+this.JoystickNumber+"down"))),this.Neutral&&"neutral"!==this.#w&&(this.#w="neutral",document.dispatchEvent(new Event("joystick"+this.JoystickNumber+"neutral"))),this.#f=t}#G(t){return"object"==typeof t?t.pressed:1==t}destroy(){this.#m&&this.debugPanel.remove()}}class i{#m;#j;#J="http://hr-cmgt.github.io/arcade-server";#L=!1;#D;get Joysticks(){return this.#j}constructor(t,e=!1,s=!1){this.#D=t,this.#L=e,this.#m=s,this.#j=[],this.#m&&this.#N("Gamepad is NOT connected. Press a button to connect"),document.addEventListener("redirect",(()=>this.#U())),window.addEventListener("gamepadconnected",(t=>this.#P(t))),window.addEventListener("gamepaddisconnected",(t=>this.#T(t)))}#U(){this.#m&&console.log("redirect!!"),window.location.href=this.#J}#P(t){if(this.#m&&(console.log("Game pad connected"),console.log("Joystick number: "+t.gamepad.index)),!this.#L&&0==this.#j.length||this.#L){let e=this.createAndAddJoystick(t.gamepad.index,6);e.PreviousGamepad=e.Gamepad,e.Gamepad=t.gamepad,null==e.PreviousGamepad&&(e.PreviousGamepad=t.gamepad)}this.#m&&this.#C()}#T(t){this.#m&&console.log("Game pad disconnected"),this.#m&&this.#N("Gamepad is NOT connected. Connect the gamepad and press a button."),this.removeJoystick(t.gamepad.index),this.#D.disconnect()}createAndAddJoystick(t,e){let i=this.getJoystickByNumber(t);if(null!=i)return i;let n=new s(t,e,this.#m);return this.#j[t]=n,n&&(document.dispatchEvent(new CustomEvent("joystickcreated",{detail:t})),console.log("joystick created")),n}removeJoystick(t){let e=this.getJoystickByNumber(t);if(null!=e){var s=this.#j.indexOf(e);"function"==typeof this.#j[s].destroy&&this.#j[s].destroy(),s>-1&&this.#j.splice(s,1)}}getJoystickByNumber(t){for(let e of this.#j)if(e.JoystickNumber==t)return e;return null}#N(t){let e,s;(e=document.getElementsByTagName("status")[0])||(e=document.createElement("status"),document.body.append(e)),e&&((s=e.getElementsByTagName("p")[0])||(s=document.createElement("p"),e.appendChild(s))),s&&(s.innerHTML=t)}#C(){let t;(t=document.getElementsByTagName("status")[0])&&t.remove()}}new class{#A;#M;constructor(){this.#A=new i(this,!0,!0),console.log("waiting for joysticks to connect"),this.#M=t=>this.#H(t),document.addEventListener("joystickcreated",this.#M)}#H(t){let e=this.#A.Joysticks[t.detail];for(const t of e.ButtonEvents)document.addEventListener(t,(()=>console.log(t)));this.update()}update(){for(let t of this.#A.Joysticks)t.update();requestAnimationFrame((()=>this.update()))}disconnect(){document.removeEventListener("joystickcreated",this.#M)}};
//# sourceMappingURL=index.6d335c2e.js.map
